function time0 = pressKey2Begin(params)% time0 = pressKey2Begin(params)%   Displays 'please press any key to begin' on the SCREEN%   just below the center of the screen and waits for the %   user to press a key.% returns the current time at start of scanif ischar(params.triggerKey)    promptString = sprintf('Please press %s key to begin.', params.triggerKey);else    promptString = 'Experiment will begin when trigger is received.';endScreen('FillRect', params.display.windowPtr, params.display.backColorRgb);drawFixation(params.display);dispStringInCenter(params.display, promptString, 0.55);iwait = 0;while ~iwait    WaitSecs(0.01);        switch params.site        case {'UMC-3T' 'UMC-7T'}                        % At these sites, the trigger is sent through a serial port            % which KbCheck cannot read, so we use PsychToolbox' IOPort                        output = deviceUMC('wait for trigger', params.siteSpecific.port);                        if ~isempty(output)                 iwait = 1;             end                                otherwise                        % KbWait and KbCheck are device dependent. We use KbCheck in a            % while loop instead of KbWait, as KbWait is reported to be            % unreliable and would need a device input as well.                        [keyIsDown, ~, c] = KbCheck(-1);                        if keyIsDown                str = KbName(find(c));                if strcmpi(str(1), params.triggerKey(1))                    % we just compare the first element in str and triggerKey                    % because if KbName and KbCheck when used togegther can                    % return unwanted characters (for example, KbName(KbCheck)                    % return '5%' when only the '5' key is pressed).                    iwait = 1;                end            end    endendtime0 = GetSecs;return;